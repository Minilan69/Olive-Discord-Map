<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Site Discord Maman Olive</title>
  <link rel="icon" href="assets/site-icon.png" type="image/png">
  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <div class="container">
    <h1>Site Officiel Du Discord De Maman Olive</h1>
    <p>Bienvenue sur le site du discord de maman olive !</p>
    <h1 id="warning">( Site En Creation )</h1>
    <div id="user-actions" style="margin-bottom: 10px;">
      <button id="homelink" onclick="window.location.href='/'">Accueil</button>
      <button id="maplink" onclick="window.location.href='/map'">Carte</button>
      <div class="spacer"></div>
      <button id="login-logout-point-btn">Connexion</button>
    </div>
    <div class="discord-widget">
        <iframe src="https://discord.com/widget?id=1376474773101744148&theme=dark" width="350" height="500" allowtransparency="true" frameborder="0" sandbox="allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts"></iframe>
    </div>
  </div>

  <footer class="bg-gray-800 text-center text-sm p-2">
    © 2025 Minilan/Okiles - <a href="https://github.com/Minilan69/Olive-Discord-Map">Projet Open Source</a>
  </footer>

  <script>
    fetch('/me')
      .then(res => res.json())
      .then(data => {
        const userActions = document.getElementById('user-actions')
        const loginBtn = document.getElementById('login-logout-point-btn')
        if (data.loggedIn) {
          loginBtn.textContent = 'Déconnexion de ' + data.username
          loginBtn.onclick = () => {
            window.location.href = '/logout?redirect=' + encodeURIComponent(window.location.pathname)
          }
        } else {
          loginBtn.textContent = 'Connexion avec Discord'
          loginBtn.onclick = () => {
            window.location.href = '/login?redirect=' + encodeURIComponent(window.location.pathname)
          }
        }
      })
  </script>
</body>
</html>
